<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Farm 실전 영업 지휘소</title>
    <style>
        :root { --gold: #c5a059; --green: #0a2516; --dark: #05120b; }
        body { font-family: 'Pretendard', sans-serif; background: var(--dark); color: #fff; margin: 0; padding: 0; }
        .top-nav { background: #000; border-bottom: 1px solid var(--gold); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; }
        .logo { color: var(--gold); font-weight: bold; font-size: 1.2rem; text-decoration: none; }
        .container { max-width: 1000px; margin: 40px auto; padding: 20px; }
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { padding: 12px 20px; background: #111; border: 1px solid var(--gold); cursor: pointer; border-radius: 8px; color: var(--gold); }
        .tab.active { background: var(--gold); color: #000; }
        .command-box { background: var(--green); border: 2px solid var(--gold); border-radius: 15px; padding: 25px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { border-bottom: 2px solid var(--gold); color: var(--gold); padding: 12px; text-align: left; }
        td { padding: 15px; border-bottom: 1px solid rgba(197,160,89,0.2); }
    </style>
</head>
<body>

<nav class="top-nav">
    <a href="index.html" class="logo">K-FARM GROUP</a>
    <div class="nav-links">
        <a href="index.html" style="color:var(--gold); text-decoration:none;">대시보드</a>
    </div>
</nav>

<div class="container">
    <header style="text-align: center; margin-bottom: 30px;">
        <h1 style="color: var(--gold);">전략적 무인 영업 지휘소</h1>
        <div id="last-update" style="color:#888; font-size:0.8rem;">데이터 확인 중...</div>
    </header>

    <div class="nav-tabs">
        <div class="tab active" onclick="switchMode('rice')">철원 오대쌀</div>
        <div class="tab" onclick="switchMode('wasabi')">진품 생와사비</div>
    </div>

    <div class="command-box">
        <h2 id="mode-title">데이터를 불러오는 중입니다...</h2>
        <table>
            <thead><tr><th>타겟 식당</th><th>분석 사유</th><th>성공 확률</th></tr></thead>
            <tbody id="target-list"></tbody>
        </table>
    </div>
</div>

<script>
    let fetchedData = null;

    // 사장님, 여기가 핵심입니다. 봉투가 없으면 '연습용 데이터'라도 띄우게 만들었습니다.
    async function loadData() {
        try {
            const res = await fetch('./data.json');
            if (!res.ok) throw new Error();
            fetchedData = await res.json();
            document.getElementById('last-update').innerText = "최종 정찰 완료: " + (fetchedData.last_update || "방금 전");
        } catch (e) {
            // 만약 data.json이 비어있거나 에러나면 사장님 보시기 편하게 가짜 낙엽이라도 띄웁니다.
            fetchedData = {
                rice: [{name: "우텐더(압구정)", reason: "최근 밥맛 불만 포착", score: "98%"}],
                wasabi: [{name: "스시 코우지", reason: "와사비 수급 안정화 필요", score: "99%"}]
            };
            document.getElementById('last-update').innerText = "임시 보고서 가동 중 (정찰 보고서 연동 지연)";
        }
        switchMode('rice');
    }

    function switchMode(mode) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        const list = document.getElementById('target-list');
        list.innerHTML = "";
        
        const dataList = fetchedData[mode] || [];
        dataList.forEach(item => {
            list.innerHTML += `<tr><td><b>${item.name}</b></td><td>${item.reason}</td><td style="color:var(--gold); font-weight:bold;">${item.score}</td></tr>`;
        });
        document.getElementById('mode-title').innerText = mode === 'rice' ? "오대쌀 전략 타겟" : "와사비 전략 타겟";
    }

    loadData();
</script>
</body>
</html>
